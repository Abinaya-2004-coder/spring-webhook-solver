SELECT d.DEPARTMENT_NAME,
       ROUND(AVG(TIMESTAMPDIFF(YEAR, e.DOB, CURRENT_DATE)), 2) AS AVERAGE_AGE,
       SUBSTRING_INDEX(
         GROUP_CONCAT(CONCAT(e.FIRST_NAME, ' ', e.LAST_NAME) ORDER BY e.FIRST_NAME, e.LAST_NAME SEPARATOR ', '),
         ', ', 10
       ) AS EMPLOYEE_LIST
FROM DEPARTMENT d
JOIN EMPLOYEE e ON d.DEPARTMENT_ID = e.DEPARTMENT
JOIN PAYMENTS p ON e.EMP_ID = p.EMP_ID
WHERE p.AMOUNT > 70000
GROUP BY d.DEPARTMENT_ID, d.DEPARTMENT_NAME
ORDER BY d.DEPARTMENT_ID DESC;
